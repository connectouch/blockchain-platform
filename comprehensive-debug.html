<!DOCTYPE html>
<html>
<head>
    <title>Connectouch Comprehensive Debug</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #0a0a0a; 
            color: #00ff00; 
            line-height: 1.6;
        }
        .error { background: #ff4444; color: white; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #44ff44; color: black; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .info { background: #4444ff; color: white; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .warning { background: #ffaa00; color: black; padding: 10px; margin: 10px 0; border-radius: 5px; }
        pre { background: #333; padding: 10px; border-radius: 5px; overflow-x: auto; color: #00ff00; }
        .section { border: 1px solid #333; margin: 20px 0; padding: 15px; border-radius: 8px; }
        .console-output { background: #000; color: #00ff00; padding: 10px; border-radius: 5px; font-family: monospace; }
    </style>
</head>
<body>
    <h1>üîç Connectouch Platform Comprehensive Debug</h1>
    <div id="results"></div>
    <div id="console-logs" class="section">
        <h3>üìã Console Logs</h3>
        <div id="console-output" class="console-output"></div>
    </div>

    <script>
        const results = document.getElementById('results');
        const consoleOutput = document.getElementById('console-output');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = message;
            results.appendChild(div);
            
            // Also add to console output
            const consoleDiv = document.createElement('div');
            consoleDiv.textContent = `[${new Date().toISOString()}] ${message}`;
            consoleOutput.appendChild(consoleDiv);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
            
            console.log(message);
        }

        // Capture ALL console methods
        const originalConsole = {
            log: console.log,
            error: console.error,
            warn: console.warn,
            info: console.info,
            debug: console.debug
        };

        ['log', 'error', 'warn', 'info', 'debug'].forEach(method => {
            console[method] = function(...args) {
                const message = args.map(arg => 
                    typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
                ).join(' ');
                
                const consoleDiv = document.createElement('div');
                consoleDiv.innerHTML = `<span style="color: ${
                    method === 'error' ? '#ff4444' : 
                    method === 'warn' ? '#ffaa00' : 
                    method === 'info' ? '#4444ff' : '#00ff00'
                }">[${method.toUpperCase()}]</span> ${message}`;
                consoleOutput.appendChild(consoleDiv);
                consoleOutput.scrollTop = consoleOutput.scrollHeight;
                
                originalConsole[method].apply(console, args);
            };
        });

        // Capture unhandled errors
        window.addEventListener('error', function(e) {
            log(`‚ùå JavaScript Error: ${e.message} at ${e.filename}:${e.lineno}:${e.colno}`, 'error');
            log(`‚ùå Stack: ${e.error?.stack || 'No stack trace'}`, 'error');
        });

        // Capture unhandled promise rejections
        window.addEventListener('unhandledrejection', function(e) {
            log(`‚ùå Unhandled Promise Rejection: ${e.reason}`, 'error');
            if (e.reason?.stack) {
                log(`‚ùå Stack: ${e.reason.stack}`, 'error');
            }
        });

        log('üöÄ Comprehensive debug script started', 'success');

        // Test 1: Environment Check
        async function testEnvironment() {
            log('<div class="section"><h3>üîß Environment Check</h3></div>');
            
            log(`User Agent: ${navigator.userAgent}`, 'info');
            log(`URL: ${window.location.href}`, 'info');
            log(`Protocol: ${window.location.protocol}`, 'info');
            log(`Host: ${window.location.host}`, 'info');
            
            // Check for required globals
            const globals = ['React', 'ReactDOM', 'process', 'module', 'require'];
            globals.forEach(global => {
                if (window[global]) {
                    log(`‚úÖ ${global} is available`, 'success');
                } else {
                    log(`‚ùå ${global} is not available`, 'error');
                }
            });
        }

        // Test 2: Network Connectivity
        async function testNetworkConnectivity() {
            log('<div class="section"><h3>üåê Network Connectivity</h3></div>');
            
            const endpoints = [
                '/assets/index-Dtv-jbOQ.js',
                '/assets/index-DoPNr-30.css',
                '/assets/vendor-Bs7gn1Hv.js',
                'https://aompecyfgnakkmldhidg.supabase.co/functions/v1/health-check'
            ];

            for (const endpoint of endpoints) {
                try {
                    const response = await fetch(endpoint);
                    if (response.ok) {
                        log(`‚úÖ ${endpoint} - OK (${response.status})`, 'success');
                        
                        if (endpoint.includes('.js')) {
                            const content = await response.text();
                            log(`üìä JS File size: ${content.length} bytes`, 'info');
                            
                            if (content.includes('React')) {
                                log(`‚úÖ Contains React code`, 'success');
                            } else {
                                log(`‚ùå No React code found`, 'error');
                            }
                        }
                    } else {
                        log(`‚ùå ${endpoint} - Failed (${response.status})`, 'error');
                    }
                } catch (error) {
                    log(`‚ùå ${endpoint} - Error: ${error.message}`, 'error');
                }
            }
        }

        // Test 3: DOM Check
        function testDOM() {
            log('<div class="section"><h3>üìÑ DOM Check</h3></div>');
            
            const root = document.getElementById('root');
            if (root) {
                log(`‚úÖ Root element found`, 'success');
                log(`üìä Root innerHTML: "${root.innerHTML}"`, 'info');
                log(`üìä Root children: ${root.children.length}`, 'info');
                log(`üìä Root classes: ${root.className}`, 'info');
            } else {
                log('‚ùå Root element not found', 'error');
            }

            // Check all script tags
            const scripts = document.querySelectorAll('script');
            log(`üìä Total script tags: ${scripts.length}`, 'info');
            
            scripts.forEach((script, index) => {
                log(`Script ${index + 1}: src="${script.src}", type="${script.type}"`, 'info');
            });
        }

        // Test 4: Module Loading
        async function testModuleLoading() {
            log('<div class="section"><h3>üì¶ Module Loading Test</h3></div>');
            
            try {
                // Try to dynamically import the main module
                const mainModule = await import('/assets/index-Dtv-jbOQ.js');
                log('‚úÖ Main module loaded successfully', 'success');
                log(`üìä Module exports: ${Object.keys(mainModule)}`, 'info');
            } catch (error) {
                log(`‚ùå Failed to load main module: ${error.message}`, 'error');
                log(`‚ùå Stack: ${error.stack}`, 'error');
            }
        }

        // Test 5: React Mounting Test
        function testReactMounting() {
            log('<div class="section"><h3>‚öõÔ∏è React Mounting Test</h3></div>');
            
            setTimeout(() => {
                const root = document.getElementById('root');
                if (root && root.children.length > 0) {
                    log('‚úÖ React has mounted content', 'success');
                    log(`üìä Root content: ${root.innerHTML.substring(0, 200)}...`, 'info');
                } else {
                    log('‚ùå React has not mounted any content', 'error');
                    
                    // Try manual React mounting
                    try {
                        root.innerHTML = `
                            <div style="padding: 20px; background: #10b981; color: white; border-radius: 10px; text-align: center;">
                                <h2>üîß Manual Test Content</h2>
                                <p>This content was manually inserted to test DOM manipulation</p>
                                <p>Time: ${new Date().toISOString()}</p>
                            </div>
                        `;
                        log('‚úÖ Manual DOM manipulation successful', 'success');
                    } catch (error) {
                        log(`‚ùå Manual DOM manipulation failed: ${error.message}`, 'error');
                    }
                }
            }, 3000);
        }

        // Run all tests
        async function runAllTests() {
            try {
                await testEnvironment();
                await testNetworkConnectivity();
                testDOM();
                await testModuleLoading();
                testReactMounting();
                
                log('<div class="section"><h3>üèÅ All tests completed</h3></div>', 'success');
            } catch (error) {
                log(`‚ùå Test suite failed: ${error.message}`, 'error');
            }
        }

        // Start tests after a short delay
        setTimeout(runAllTests, 1000);
    </script>
</body>
</html>
