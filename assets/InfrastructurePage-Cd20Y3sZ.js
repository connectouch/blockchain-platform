var S=Object.defineProperty;var C=(l,r,a)=>r in l?S(l,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[r]=a;var x=(l,r,a)=>C(l,typeof r!="symbol"?r+"":r,a);import{j as e,l as j,R as u,aM as k,m,Z as T,D as I,a as R,A as E,n as D}from"./ui-CIGGqqhk.js";import{r as c}from"./router-B3YxnSyQ.js";import{u as P}from"./web3-CeUyKLFI.js";import{c as h,d as L}from"./index-CzZ89WQn.js";import{L as A}from"./LoadingSpinner-Bh1ygWPB.js";import"./vendor-DBnw6Ey0.js";import"./utils-C0Bg54wM.js";import"@prisma/client";import"redis";import"pg";class F extends c.Component{constructor(a){super(a);x(this,"handleRetry",()=>{console.log("Retrying infrastructure page..."),this.setState(a=>({hasError:!1,error:null,errorInfo:null,retryCount:a.retryCount+1}))});x(this,"handleGoHome",()=>{window.location.href="/"});x(this,"handleHardRefresh",()=>{window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null,retryCount:0}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,o){console.error("SafeInfrastructureWrapper caught an error:",a,o),console.group("Infrastructure Page Error Details"),console.error("Error:",a),console.error("Error Info:",o),console.error("Component Stack:",o.componentStack),console.error("Error Stack:",a.stack),console.groupEnd(),this.setState({error:a,errorInfo:o})}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 via-purple-900 to-violet-900",children:e.jsx("div",{className:"max-w-2xl w-full mx-4",children:e.jsxs("div",{className:"glass-card p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(j,{className:"w-8 h-8 text-red-400"})}),e.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Infrastructure Page Error"}),e.jsx("p",{className:"text-white/70 mb-6",children:"The infrastructure page encountered an unexpected error. This has been logged for debugging."}),!1,e.jsxs("div",{className:"mb-6 p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg text-left",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-400 mb-2",children:"Troubleshooting:"}),e.jsxs("ul",{className:"text-xs text-blue-300 space-y-1",children:[e.jsx("li",{children:"• Try refreshing the page (Ctrl+F5 or Cmd+Shift+R)"}),e.jsx("li",{children:"• Clear browser cache and cookies"}),e.jsx("li",{children:"• Check browser console for additional errors"}),e.jsx("li",{children:"• Try a different browser or incognito mode"}),e.jsx("li",{children:"• Ensure backend server is running on port 5175"})]})]}),e.jsxs("div",{className:"flex gap-3 justify-center flex-wrap",children:[e.jsxs("button",{onClick:this.handleRetry,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[e.jsx(u,{className:"w-4 h-4"}),"Try Again"]}),e.jsxs("button",{onClick:this.handleHardRefresh,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:[e.jsx(u,{className:"w-4 h-4"}),"Hard Refresh"]}),e.jsxs("button",{onClick:this.handleGoHome,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors",children:[e.jsx(k,{className:"w-4 h-4"}),"Go Home"]})]}),!1]})})}):e.jsx("div",{children:this.props.children},`infrastructure-${this.state.retryCount}`)}}const $=()=>{const[l,r]=c.useState([]),[a,o]=c.useState(0),[i,p]=c.useState([]),[b,N]=c.useState(new Date),d=t=>{console.log(`[InfrastructurePage] ${t}`),r(s=>[...s.slice(-4),`${new Date().toISOString()}: ${t}`])};c.useEffect(()=>(d("Component mounted"),()=>d("Component unmounted")),[]);const{data:n=[],isLoading:f,error:g,refetch:w}=P({queryKey:["infrastructure","projects",a],queryFn:async()=>{d("Starting API call");try{const t=await L.getInfrastructureProjects();return d(`API call successful: ${t?.length||0} projects`),t}catch(t){throw d(`API call failed: ${t instanceof Error?t.message:"Unknown error"}`),t}},staleTime:1e3*60*5,retry:3,retryDelay:1e3});c.useEffect(()=>((async()=>{try{await h.initialize(),h.on("infrastructureUpdated",v=>{p(v),N(new Date)});const s=h.getInfrastructureData();p(s)}catch(s){console.warn("Real-time infrastructure data initialization failed:",s)}})(),()=>{h.removeAllListeners()}),[]);const y=()=>{d("Force refresh triggered"),o(t=>t+1),w()};return e.jsx("div",{className:"min-h-screen py-20 px-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs(m.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center mb-16",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-cyan-400 to-blue-500 rounded-2xl flex items-center justify-center mx-auto mb-6",children:e.jsx(T,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-5xl font-bold text-white mb-4",children:"Infrastructure"}),e.jsx("p",{className:"text-xl text-white/70 max-w-2xl mx-auto",children:"Explore Layer 1/2 blockchains and scaling solutions"})]}),i.length>0&&e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Real-Time Infrastructure Metrics"}),e.jsxs("span",{className:"text-sm text-green-400",children:["Updated: ",b.toLocaleTimeString()]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white/60 text-sm",children:"Network Uptime"}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[(i.reduce((t,s)=>t+s.uptime,0)/i.length).toFixed(1),"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white/60 text-sm",children:"Active Validators"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:i.reduce((t,s)=>t+s.validators,0).toLocaleString()})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white/60 text-sm",children:"Avg Staking APY"}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[(i.reduce((t,s)=>t+s.stakingAPY,0)/i.length).toFixed(1),"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white/60 text-sm",children:"Top Network"}),e.jsx("p",{className:"text-lg font-bold text-white",children:i.sort((t,s)=>s.validators-t.validators)[0]?.name.slice(0,10)})]})]})]})}),f&&e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(A,{})}),g&&e.jsx("div",{className:"text-center py-20",children:e.jsxs("div",{className:"glass-card p-8 max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx(j,{className:"w-8 h-8 text-red-400 mr-3"}),e.jsx("h3",{className:"text-xl font-bold text-red-400",children:"Error Loading Infrastructure Data"})]}),e.jsx("p",{className:"text-white/70 mb-4",children:"Unable to fetch project data. Please try again later."}),!1,e.jsxs("button",{onClick:y,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors mx-auto",children:[e.jsx(u,{className:"w-4 h-4"}),"Retry"]})]})}),!f&&!g&&n.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-8 mb-16",children:n.map((t,s)=>e.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:s*.1},className:"glass-card p-6 hover:scale-105 transition-transform duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:t.name}),e.jsx("span",{className:"px-3 py-1 bg-cyan-500/20 text-cyan-400 rounded-full text-sm",children:t.category})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-white/70",children:"Market Cap"}),e.jsxs("span",{className:"text-green-400 font-semibold",children:["$",((t.marketCap||0)/1e9).toFixed(1),"B"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-white/70",children:"TPS"}),e.jsx("span",{className:"text-blue-400 font-semibold",children:t.tps&&t.tps>0?`${t.tps.toLocaleString()}`:"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-white/70",children:"TVL"}),e.jsxs("span",{className:"text-purple-400 font-semibold",children:["$",((t.tvl||0)/1e9).toFixed(1),"B"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-white/70",children:"Gas Price"}),e.jsx("span",{className:"text-yellow-400 font-semibold",children:t.gasPrice&&t.gasPrice>0?`${t.gasPrice} Gwei`:"Low"})]}),t.validators&&t.validators>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-white/70",children:"Validators"}),e.jsx("span",{className:"text-white font-semibold",children:t.validators.toLocaleString()})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white/70 text-sm",children:"Consensus"}),e.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs",children:t.consensus})]}),e.jsx("p",{className:"text-white/60 text-sm",children:t.description}),e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:"text-white/50 text-xs",children:["Launched: ",t.launched]})})]})]},t.name))}),e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"mt-16",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"glass-card p-6 text-center",children:[e.jsx(I,{className:"w-12 h-12 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Total Market Cap"}),e.jsxs("p",{className:"text-3xl font-bold text-green-400",children:["$",(n.reduce((t,s)=>t+(s.marketCap||0),0)/1e9).toFixed(0),"B"]})]}),e.jsxs("div",{className:"glass-card p-6 text-center",children:[e.jsx(R,{className:"w-12 h-12 text-purple-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Total TVL"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-400",children:["$",(n.reduce((t,s)=>t+(s.tvl||0),0)/1e9).toFixed(0),"B"]})]}),e.jsxs("div",{className:"glass-card p-6 text-center",children:[e.jsx(E,{className:"w-12 h-12 text-blue-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Max TPS"}),e.jsx("p",{className:"text-3xl font-bold text-blue-400",children:n.filter(t=>t.tps&&t.tps>0).length>0?Math.max(...n.filter(t=>t.tps&&t.tps>0).map(t=>t.tps)).toLocaleString():"N/A"})]}),e.jsxs("div",{className:"glass-card p-6 text-center",children:[e.jsx(D,{className:"w-12 h-12 text-cyan-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Networks"}),e.jsx("p",{className:"text-3xl font-bold text-cyan-400",children:n.length})]})]})})]}),!1]})})},K=()=>e.jsx(F,{children:e.jsx($,{})});export{K as default};
